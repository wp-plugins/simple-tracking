<?php

/**

 * Plugin Name: Simple Tracking
 * Description: Einfaches Conversion-Tracking-Plugin für Wordpress, welches man ganz einfach auf einer Seite oder einem Post einbinden kann
 * Version: 0.1
 * Author: Fabian Renner
 * Author URI: http://www.vionic.de
 */
/**
 * Changelog:
 * 05/27/2010: 0.1
 * 	- Original first Version
 */
/*  Copyright 2010  Fabian Renner  (email : renner@vionic.de)
    This program is free software; you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation; either version 2 of the License, or
    (at your option) any later version.
    This program is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.
    You should have received a copy of the GNU General Public License
    along with this program; if not, write to the Free Software
    Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
*/
    function simpleTracker_adminMenu()    {        add_meta_box('simpleTracking', 'Simple Tracking', 'simpleTracker_insertForm', 'post', 'normal');			add_meta_box('simpleTracking', 'Simple Tracking', 'simpleTracker_insertForm', 'page', 'normal');				add_menu_page('Simple Tracking', 'Simple Tracking','manage_options','simpleTracking', 'simpleTracker_configPage','div');    }	    function simpleTracker_configPage()    {        $title = 'Simple Tracking';		$message = __('Sie haben erfolgreich upgedatet!', 'simple-tracking');        if ($_GET['updated']) { ?>			            <div id="message" class="updated fade"><p><?php echo $message; ?></p></div><?php 		} ?>		            <div class="wrap">				<div id="icon-simpleTracking" class="icon32"><br /></div>                <h2><?php echo $title; ?></h2>                <form action="options.php" method="post">                    <?php wp_nonce_field('update-options'); ?>     					<p style="margin-left: 10px;"><?php _e('Sie k&ouml;nnen hier 3 verschiedene Trackingcodes eingeben.', 'simple-tracking') ?></p>					<p style="margin-left: 10px;"><?php _e('Geben Sie zur eigenen &Uuml;bersicht einen Titel mit an. Dieser ist nur f&uuml;r Sie sichtbar.', 'simple-tracking') ?></p>  					<table class="form-table">						<tr valign="top">                            <th scope="row"><?php _e('Titel Trackingcode 1', 'simple-tracking') ?></th>                            <td>                                <input type="text" size="40" style="width:400px;" name="simpleTracking_betreff1" id="simpleTracking_betreff1" value="<?php echo get_option('simpleTracking_betreff1'); ?>" />                            </td>                        </tr>						<tr>                            <th scope="row"><?php _e('Code 1', 'simple-tracking') ?></th>                            <td>                                <textarea rows="10" cols="40" style="width:400px;" name="simpleTracking_code1" id="simpleTracking_code1" value=""><?php echo get_option('simpleTracking_code1'); ?></textarea>                            </td>					</table>										<p style="margin-left: 10px;"><?php _e('Geben Sie im Editor auf einer Seite oder einem Artikel folgenden Shortcode ein: <strong>[[[simpleTracking_shortcut1]]]</strong>.</p><p style="margin-left: 10px;">Alternativ klicken Sie auf der Seite oder dem Artikel unter dem Editor auf den entsprechenden Einf&uuml;ge-Button des Plugins.', 'simple-tracking') ?></p>										<table style="margin-top: 40px;" class="form-table">						<tr>                            <th scope="row"><?php _e('Titel Trackingcode 2', 'simple-tracking') ?></th>                            <td>                                <input type="text" size="40" style="width:400px;" name="simpleTracking_betreff2" id="simpleTracking_betreff2" value="<?php echo get_option('simpleTracking_betreff2'); ?>" />                            </td>                        </tr>						<tr>                            <th scope="row"><?php _e('Code 2', 'simple-tracking') ?></th>                            <td>                                <textarea rows="10" cols="40" style="width:400px;" name="simpleTracking_code2" id="simpleTracking_code2" value=""><?php echo get_option('simpleTracking_code2'); ?></textarea>                            </td>                        </tr>					</table>					<p style="margin-left: 10px;"><?php _e('Geben Sie im Editor auf einer Seite oder einem Artikel folgenden Shortcode ein: <strong>[[[simpleTracking_shortcut2]]]</strong>.</p><p style="margin-left: 10px;">Alternativ klicken Sie auf der Seite oder dem Artikel unter dem Editor auf den entsprechenden Einf&uuml;ge-Button des Plugins.', 'simple-tracking') ?></p>										<table style="margin-top: 40px;" class="form-table">						<tr>                            <th scope="row"><?php _e('Titel Trackingcode 3', 'simple-tracking') ?></th>                            <td>                                <input type="text" size="40" style="width:400px;" name="simpleTracking_betreff3" id="simpleTracking_betreff3" value="<?php echo get_option('simpleTracking_betreff3'); ?>" />                            </td>                        </tr>						<tr>                            <th scope="row"><?php _e('Code 3', 'simple-tracking') ?></th>                            <td>                                <textarea rows="10" cols="40" style="width:400px;" name="simpleTracking_code3" id="simpleTracking_code3" value=""><?php echo get_option('simpleTracking_code3'); ?></textarea>                            </td>                        </tr>                   </table>				   <p style="margin-left: 10px;"><?php _e('Geben Sie im Editor auf einer Seite oder einem Artikel folgenden Shortcode ein: <strong>[[[simpleTracking_shortcut3]]]</strong>.</p><p style="margin-left: 10px;">Alternativ klicken Sie auf der Seite oder dem Artikel unter dem Editor auf den entsprechenden Einf&uuml;ge-Button des Plugins.', 'simple-tracking') ?></p>                    <p class="submit">                        <input type="submit" name="Submit" value="<?php _e('Speichern &raquo;', 'simple-tracking'); ?>" />                    </p>					<input type="hidden" name="action" value="update" />                    <input type="hidden" name="page_options" value="simpleTracking_betreff1,simpleTracking_code1,simpleTracking_betreff2,simpleTracking_code2,simpleTracking_betreff3,simpleTracking_code3" />                </form>				<?php    }		function simpleTracker_insertForm() {?>		<script type="text/javascript">			jQuery(document).ready(function(){								var ergebnisbox1 = '[[[simpleTracking_shortcut1]]]';				var ergebnisbox2 = '[[[simpleTracking_shortcut2]]]';				var ergebnisbox3 = '[[[simpleTracking_shortcut3]]]';				jQuery('#simpleTracking_submit1').click(function(){									var displaychecker = jQuery('#editorcontainer textarea').css('display');																			if(displaychecker == 'none'){						mce = jQuery('#content_ifr').contents().find('body');						mceHtml = mce.html();						mce.html(mceHtml + ergebnisbox1);											} else {						textareaVar = jQuery('#editorcontainer textarea');						textEditor = textareaVar.val();						textareaVar.val(textEditor + ergebnisbox1);										}				});								jQuery('#simpleTracking_submit2').click(function(){									var displaychecker = jQuery('#editorcontainer textarea').css('display');																			if(displaychecker == 'none'){						mce = jQuery('#content_ifr').contents().find('body');						mceHtml = mce.html();						mce.html(mceHtml + ergebnisbox2);											} else {						textareaVar = jQuery('#editorcontainer textarea');						textEditor = textareaVar.val();						textareaVar.val(textEditor + ergebnisbox2);										}				});								jQuery('#simpleTracking_submit3').click(function(){									var displaychecker = jQuery('#editorcontainer textarea').css('display');																			if(displaychecker == 'none'){						mce = jQuery('#content_ifr').contents().find('body');						mceHtml = mce.html();						mce.html(mceHtml + ergebnisbox3);											} else {						textareaVar = jQuery('#editorcontainer textarea');						textEditor = textareaVar.val();						textareaVar.val(textEditor + ergebnisbox3);										}				});			});					</script>		<p style="padding: 5px;"><strong><?php _e('F&uuml;gen Sie hier einfach per Klick auf den entsprechenden "Einf&uuml;gen-Button" Ihr Trackingcode Shortcut ein.', 'simple-tracking');?> </p>		<p style="padding: 5px;"><?php _e('Im Frontend wird dann der Trackingcode ausgef&uuml;ührt und das Shortcut verschwindet.', 'simple-tracking');?></strong><br /><br />	</p>		<table class="form-table">			<tr valign="top">                <th scope="row"><label for="simpleTracking_betreff1"><?php echo get_option('simpleTracking_betreff1'); ?></label></th>                <td>					<input id="simpleTracking_submit1" type="button" value="<?php echo get_option('simpleTracking_betreff1') . ' einf&uuml;gen'; ?>" />                </td>            </tr>			<tr>                <th scope="row"><label for="simpleTracking_betreff2"><?php echo get_option('simpleTracking_betreff2'); ?></label></th>                <td>					<input id="simpleTracking_submit2" type="button" value="<?php echo get_option('simpleTracking_betreff2') . ' einf&uuml;gen'; ?>" />                </td>            </tr>			<tr>                <th scope="row"><label for="simpleTracking_betreff3"><?php echo get_option('simpleTracking_betreff3'); ?></label></th>                <td>					<input id="simpleTracking_submit3" type="button" value="<?php echo get_option('simpleTracking_betreff3') . ' einf&uuml;gen'; ?>" />                </td>            </tr>			        </table>        <p>&nbsp;</p>		<?php    }		add_action('admin_menu', 'simpleTracker_adminMenu');			function simpleTracker_options_install() {		add_option('simpleTracking_betreff1', 'Titel 1');	add_option('simpleTracking_code1', '<script>alert("1");</script>');		add_option('simpleTracking_betreff2', 'Titel 2');	add_option('simpleTracking_code2', '<script>alert("2");</script>');		add_option('simpleTracking_betreff3', 'Titel 3');	add_option('simpleTracking_code3', '<script>alert("3");</script>');	}	function simpleTracker_options_uninstall(){		delete_option('simpleTracking_betreff1');		delete_option('simpleTracking_code1');				delete_option('simpleTracking_betreff2');		delete_option('simpleTracking_code2');				delete_option('simpleTracking_betreff3');		delete_option('simpleTracking_code3');	}register_activation_hook(__FILE__, 'simpleTracker_options_install' );if (function_exists('register_uninstall_hook')){	register_uninstall_hook(__FILE__, 'simpleTracker_options_uninstall'); } else  {	register_deactivation_hook(__FILE__, 'simpleTracker_options_uninstall'); }  function simpleTracker_filterTracking($content){	$content = str_replace('[[[simpleTracking_shortcut1]]]',get_option('simpleTracking_code1'), $content);	$content = str_replace('[[[simpleTracking_shortcut2]]]',get_option('simpleTracking_code2'), $content);	$content = str_replace('[[[simpleTracking_shortcut3]]]',get_option('simpleTracking_code3'), $content);			return $content;}  add_filter('the_content', 'simpleTracker_filterTracking');	 add_action('admin_head', 'simpleTracker_tracking_css');/** * Ausgabe der Admin CSS */function simpleTracker_tracking_css() {    echo '<link id="dpm_css" rel="stylesheet" href="'.get_settings('siteurl').'/wp-content/plugins/simple-tracking/adminTracking.css" type="text/css" media="screen" />';}?>